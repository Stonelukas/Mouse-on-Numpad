# Maintainer: stonelukas <https://github.com/Stonelukas>
pkgname=mouse-on-numpad
pkgver=1.0.0
pkgrel=1
pkgdesc="Control mouse with numpad keys - Enhanced Linux port with GTK4 GUI"
arch=('any')
url="https://github.com/Stonelukas/mouse-on-numpad"
license=('MIT')
depends=(
    'python>=3.10'
    'python-pynput'
    'python-gobject'
    'gtk4'
    'python-pulsectl'
    'python-xlib'
    'python-evdev'
)
makedepends=(
    'python-build'
    'python-installer'
    'python-hatchling'
)
optdepends=(
    'libnotify: Desktop notifications'
    'polkit: Input device access without root'
)
source=("$pkgname-$pkgver.tar.gz::https://github.com/Stonelukas/mouse-on-numpad/archive/v$pkgver.tar.gz")
sha256sums=('SKIP')  # Update with actual checksum on release

build() {
    cd "$pkgname-$pkgver"
    python -m build --wheel --no-isolation
}

check() {
    cd "$pkgname-$pkgver"
    # Run tests if available
    # python -m pytest tests/
}

package() {
    cd "$pkgname-$pkgver"

    # Install Python package
    python -m installer --destdir="$pkgdir" dist/*.whl

    # Install desktop entry
    install -Dm644 packaging/mouse-on-numpad.desktop \
        "$pkgdir/usr/share/applications/mouse-on-numpad.desktop"

    # Install systemd user service
    install -Dm644 packaging/mouse-on-numpad.service \
        "$pkgdir/usr/lib/systemd/user/mouse-on-numpad.service"

    # Install polkit policy
    install -Dm644 packaging/com.github.mouse-on-numpad.policy \
        "$pkgdir/usr/share/polkit-1/actions/com.github.mouse-on-numpad.policy"

    # Install icon (placeholder - create actual icon later)
    # install -Dm644 data/icons/app-icon.svg \
    #     "$pkgdir/usr/share/icons/hicolor/scalable/apps/mouse-on-numpad.svg"

    # Install documentation
    install -Dm644 README.md "$pkgdir/usr/share/doc/$pkgname/README.md"
    install -Dm644 docs/installation.md "$pkgdir/usr/share/doc/$pkgname/installation.md"

    # Install license
    install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
